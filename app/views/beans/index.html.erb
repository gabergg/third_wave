<% provide(:title, 'Beans') %>

<h1>Beans</h1>

<div class="row">

  
  <div class="span8 offset3">
      <% @beans.each do |bean| %>
        <div class="eachbean">
          <div class="row-fluid">
            <div class="span3">
              <%= image_tag "placeholder.png" %>
            </div>
            <div class="span5">
              <span class="roaster"><%= link_to bean.roaster.name, bean.roaster %></span><br>
              <span class="bean"><%= link_to bean.name, bean %></span><br><br>
              <span class="roast"><%= bean.roast %></span><br>
              <span class="origin">  <%= bean.origin %></span><br>
              <span class="rating"><%= bean.avg_rating != "None" ? bean.avg_rating.round(2) : "None" %></span><br>
              <span class="rate_button">
                <% if signed_in? %>
                    <%= link_to "Rate", new_review_path(:bean_id => bean.id) %>
                <% end %>
              </span><br>
                <% if current_user && current_user.admin? %>
                    <%= link_to "Remove", bean, method: :delete, data: {confirm: "Are you sure?"} %>
                <% end %>
            </div>
          </div> 
        </div>
      <% end %>
   

    

    <%= button_tag "Add a bean", type: "button", onclick: "$('#new-bean-form').toggle()",
                   class: "btn btn-small btn-primary" %>

    <div id="new-bean-form" style="display: none;">
      <%= form_for(@bean) do |f| %>
          <%= render 'shared/error_messages', object: f.object %>

          <%= f.label :roaster_name %>
          <%= f.text_field :roaster_name, data: {autocomplete_roaster_source: '/roastersearch'} %>

          <%= f.label :name %>
          <%= f.text_field :name %>

          <%= f.label :roast %>
          <%= f.text_field :roast %>

          <%= f.label :origin %>
          <%= f.text_field :origin %>
          <br>

          <%= f.submit "Submit Bean", class: "btn btn-large btn-primary" %>
      <% end %>
    </div>
  </div>

</div>

<script>init_auto_roaster()</script>